# Vulnerability Scan Lab in Azure

## Introduction
This repository documents my experience conducting a vulnerability scan using OpenVAS in an Azure environment. The purpose of this lab was to assess the security posture of a Server 2022 instance with various configurations.

## Lab Setup
- **Environment**: Azure Cloud
- **Target Machine**: Server 2022, IP 10.10.1.22
- **Scanning Tool**: OpenVAS on Parrot OS

## Process Overview
1. **Initial Setup**:
   - Created a Server 2022 VM in Azure.
   - Created a Parrot OS VM in Azure.
   - Utilized a machine that was on my internal network to conduct a Vunerability Scan using OpenVAS.
   - Pre-configured the VM with no updates and firewall turned off for initial scanning.
   - Re-configure the VM with a firewall change for another scan

2. **Scanning with OpenVAS**:
   - Logged into Parrot OS VM in Azure.
   - Conducted an initial quick scan using OpenVAS on the target Server 2022 VM.

3. **Findings and Analysis**:
   - During the vulnerability scanning exercise, I used OpenVAS to conduct a comprehensive assessment of a Server 2022 VM created in Azure. Below are the highlights of my findings:

**High-Severity Vulnerabilities**
- Several high-severity vulnerabilities related to SMB (Server Message Block) services were identified, including multiple NTLM (NT LAN Manager) vulnerabilities (CVE-2010-0020, CVE-2010-0021, CVE-2010-0022, CVE-2010-0231). These weaknesses could potentially allow an attacker to execute remote code or cause a denial of service.
- Remote Code Execution vulnerabilities in SMB2 (CVE-2009-2526, CVE-2009-2532, CVE-2009-3103) were detected, which could grant unauthorized access and control over the system to an attacker.

**Medium-Severity Vulnerabilities**
- The scan uncovered medium-severity vulnerabilities concerning deprecated SSL/TLS protocols, such as TLSv1.0 and TLSv1.1 (no specific CVE listed). These outdated protocols are susceptible to multiple forms of cryptographic attacks, making encrypted data streams vulnerable to interception or decryption.
- DCE/RPC and MSRPC Services Enumeration Reporting indicated medium-severity issues, potentially exposing sensitive information about the network services running on the machine, which could be leveraged for more targeted attacks.

**Low-Severity and Informational Findings**
- Among lower-severity issues, the scan reported potential problems with TCP timestamps (no specific CVE listed). While less critical, these findings suggest possible ways to estimate the uptime of the server, potentially aiding in reconnaissance efforts.

4. **Modifying Configurations and Re-scanning**:
- Turned the firewall back on the Server 2022 VM.
- Conducted a second scan to assess changes in the vulnerability landscape.
-  Nothing has changed in the next scan.
  
5. **Remediation and Hardening Steps**
- Applying the latest security patches to address the NTLM vulnerabilities.
- Disabling or updating the deprecated SSL/TLS protocols to more secure versions.
- Reviewing and restricting the visibility of network services to prevent information leakage.

6. **Comparison and Conclusions**:
The comparative analysis of the vulnerability scans before and after the firewall was enabled on the Server 2022 VM yielded insightful results:

**Scan Comparison**
- Pre-Firewall Configuration: The initial scan with the firewall disabled revealed several high and medium-severity vulnerabilities, predominantly associated with SMB services and deprecated SSL/TLS protocols. This state represented a significant security risk with numerous potential attack vectors for exploitation.

- Post-Firewall Configuration: After re-enabling the firewall, a subsequent scan was performed. Contrary to expectations, there was no change in the number of detected vulnerabilities. This outcome indicates that the firewall's default configuration did not mitigate the specific vulnerabilities identified in the initial scan.

7. **Conclusions**
- Firewall Efficacy: The unchanged vulnerability landscape post-firewall reconfiguration highlights a critical point: while firewalls are a fundamental security measure, their default settings may not be sufficient to protect against all types of vulnerabilities, particularly those that do not involve direct network access.

- Security Posture: The findings underscore the importance of a layered security approach. A firewall alone, without proper configuration and complemented by other security measures such as regular updates and secure protocols, does not ensure the security of a system.

- Best Practices: This exercise reinforces the best practice of regularly updating systems and disabling outdated protocols. It also emphasizes the need for thorough security audits to tailor firewall rules and settings to the specific needs of the system and network.

- Remediation Steps: Despite the firewall reconfiguration not impacting the initial findings, the recommended remediation steps, including applying security patches and updating protocols, were carried out. These actions are expected to enhance the security stance significantly.

## Files in this Repository
- `Scans/`: Contains all the scan reports.
- `Screenshots/`: Screenshots of the setup and scanning process.
- `Other/`: Any other relevant documents.

## Reflections
In this lab, I gained hands-on experience in several key areas of cybersecurity and system administration, including:

- **Virtual Machine Configuration**:
  - Successfully set up and configured a Parrot OS virtual machine and a Server 2022 VM in the Azure environment.
  - Learned the nuances of VM management in a cloud setting, dealing with network configurations, and resource allocation.

- **Vulnerability Scanning with OpenVAS**:
  - Explored the functionalities of OpenVAS, an open-source tool, for conducting comprehensive vulnerability scans.
  - Understood the process of scanning a networked system, analyzing the scan results, and identifying potential security vulnerabilities.

- **Practical Application of Security Concepts**:
  - Applied theoretical knowledge of network security in a practical setting, enhancing my understanding of real-world cybersecurity challenges.
  - Developed a deeper appreciation for the importance of regular security assessments in maintaining a strong security posture.

## Disclaimer
This repository and all associated files are for educational purposes only and were created as part of a cybersecurity lab exercise. The vulnerability scans and configurations were performed in a controlled lab environment on virtual machines specifically set up for this training. No real-world or production systems were targeted, and the scans were executed in accordance with ethical hacking guidelines and with respect to privacy and legality. This content is not intended for use as a guide for malicious hacking, and the author does not condone unauthorized or illegal use of the information provided. The techniques and methods demonstrated here should not be applied without proper authorization and within the bounds of applicable laws and regulations.

## Author
- Eric Noga 1/3/2024

